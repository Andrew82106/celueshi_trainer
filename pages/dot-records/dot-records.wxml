<!--pages/dot-records/dot-records.wxml-->
<navigation-bar title="åœ†ç‚¹é—ªè§†è®°å½•" back="{{true}}"bindback="onBack"></navigation-bar>

<view class="container">
  <!-- æŠ˜çº¿å›¾åŒºåŸŸ -->
  <view class="chart-section">
    <view class="section-title">è®­ç»ƒè¶‹åŠ¿</view>
    <view class="chart-container">
      <canvas canvas-id="avgTimeChart" style="width: {{canvasWidth}}px; height: {{canvasHeight}}px;"></canvas>
    </view>
    <view class="chart-legend">
      <text>è®­ç»ƒè®°å½• (æ¨ªè½´: è®­ç»ƒæ¬¡åº, çºµè½´: å¹³å‡åœ†ç‚¹è§‚å¯Ÿæ—¶é—´-æ¯«ç§’/ä¸ª)</text>
    </view>
  </view>
  
  <!-- è®­ç»ƒè®°å½•è¯¦æƒ…åŒºåŸŸ -->
  <view class="records-section">
    <view class="section-title">è®­ç»ƒè®°å½•è¯¦æƒ…</view>
    <block wx:for="{{records}}" wx:key="index">
      <view class="record-card">
        <view class="card-header">
          <view class="dot-badge">{{item.correct}}ä¸ªåœ†ç‚¹</view>
          <view class="time-stamp">{{item.formattedDate}}</view>
          <view 
              class="delete-btn" 
              bindtap="deleteRecord" 
              data-index="{{index}}"
          >
              <view class="delete-icon"></view>
          </view>
        </view>
        
        <view class="stats-grid">
          <view class="stat-item">
            <view class="stat-icon">â³</view>
            <view class="stat-content">
              <text class="stat-label">é—ªè§†æ—¶é•¿</text>
              <text class="stat-value">{{item.duration}}</text>
            </view>
          </view>
          
          <view class="stat-item">
            <view class="stat-icon">ğŸ¯</view>
            <view class="stat-content">
              <text class="stat-label">å‡†ç¡®ç‡</text>
              <text class="stat-value">{{item.accuracy}}</text>
            </view>
          </view>
        </view>
        
        <view class="stat-highlight">
          <view class="stat-icon">âš¡</view>
          <view class="stat-content">
            <text class="stat-label">å¹³å‡è§‚å¯Ÿæ—¶é—´</text>
            <text class="stat-value highlight">{{item.avgObservationTime}} æ¯«ç§’/ä¸ª</text>
          </view>
        </view>
        
        <view class="stats-detail">
          <view class="detail-item">
            <text class="detail-label">æ¯«ç§’æ•°ï¼š</text>
            <text class="detail-value">{{item.milliseconds}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">ç”¨æˆ·ç­”æ¡ˆï¼š</text>
            <text class="detail-value">{{item.userAnswer}}</text>
          </view>
        </view>
      </view>
    </block>
  </view>
</view>